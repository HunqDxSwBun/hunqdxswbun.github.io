<!DOCTYPE html>
<html>
<head>
  <title>Chuyển đổi PDF thành PNG</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
</head>
<body>
  <h1>Chuyển đổi PDF thành PNG</h1>

  <input type="file" id="fileInput">
  <br><br>
  <input type="text" id="urlInput" placeholder="Nhập URL PDF">
  <br><br>
  <button onclick="chuyenDoi()">Chuyển đổi</button>

  <script>
    function chuyenDoi() {
      var fileInput = document.getElementById('fileInput');
      var urlInput = document.getElementById('urlInput');

      var pdfFile;

      if (fileInput.files.length > 0) {
        pdfFile = fileInput.files[0];
      } else if (urlInput.value !== '') {
        pdfFile = urlInput.value;
      } else {
        alert('Vui lòng chọn tệp PDF hoặc nhập URL PDF!');
        return;
      }

      var reader = new FileReader();

      reader.onload = function(e) {
        var arrayBuffer = e.target.result;

        // Sử dụng pdf.js để đọc tệp PDF
        pdfjsLib.getDocument(arrayBuffer).promise.then(function(pdfDoc) {
          var pageNum = 1; // Chỉ chuyển đổi trang đầu tiên
          return pdfDoc.getPage(pageNum);
        }).then(function(page) {
          var canvas = document.createElement('canvas');
          var viewport = page.getViewport({ scale: 1.0 });
          var context = canvas.getContext('2d');
          canvas.height = viewport.height;
          canvas.width = viewport.width;

          var renderContext = {
            canvasContext: context,
            viewport: viewport
          };

          // Vẽ trang PDF lên canvas
          return page.render(renderContext).promise;
        }).then(function() {
          // Chuyển đổi canvas thành hình ảnh PNG
          var canvas = document.querySelector('canvas');
          var imageURL = canvas.toDataURL('image/png');
          var imageLink = document.createElement('a');
          imageLink.href = imageURL;
          imageLink.download = 'converted.png';
          imageLink.click();
        });
      };

      reader.readAsArrayBuffer(pdfFile);
    }
  </script>
</body>
</html>
